---

title: fastscript

keywords: fastai
sidebar: home_sidebar

summary: "API details"
description: "API details"
nb_path: "00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_eq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> <span class="k">assert</span> <span class="n">a</span><span class="o">==</span><span class="n">b</span><span class="p">,</span><span class="n">a</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Param" class="doc_header"><code>class</code> <code>Param</code><a href="https://github.com/fastai/fastscript/tree/master/fastscript/core.py#L10" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Param</code>(<strong><code>help</code></strong>=<em><code>None</code></em>, <strong><code>type</code></strong>=<em><code>None</code></em>, <strong><code>opt</code></strong>=<em><code>True</code></em>, <strong><code>action</code></strong>=<em><code>None</code></em>, <strong><code>nargs</code></strong>=<em><code>None</code></em>, <strong><code>const</code></strong>=<em><code>None</code></em>, <strong><code>choices</code></strong>=<em><code>None</code></em>, <strong><code>required</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>A parameter in a function used in <a href="/core.html#anno_parser"><code>anno_parser</code></a> or <a href="/core.html#call_parse"><code>call_parse</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Each parameter in your function should have an annotation <code>Param(...)</code>. You can pass the following when calling <a href="/core.html#Param"><code>Param</code></a>: <code>help</code>,<code>type</code>,<code>opt</code>,<code>action</code>,<code>nargs</code>,<code>const</code>,<code>choices</code>,<code>required</code> (i.e. it takes the same parameters as <code>argparse.ArgumentParser.add_argument</code>, plus <code>opt</code>). Except for <code>opt</code>, all of these are just passed directly to <code>argparse</code>, so you have all the power of that module at your disposal. Generally you'll want to pass at least <code>help</code> (since this is provided as the help string for that parameter) and <code>type</code> (to ensure that you get the type of data you expect).</p>
<p><code>opt</code> is a bool that defines whether a param is optional or required (positional) - but you'll generally not need to set this manually, because fastscript will set it for you automatically based on <em>default</em> values. You should provide a default (after the <code>=</code>) for any <em>optional</em> parameters. If you don't provide a default for a parameter, then it will be a <em>positional</em> parameter.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_default</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">kwargs</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;help (default: 1)&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bool_arg" class="doc_header"><code>bool_arg</code><a href="https://github.com/fastai/fastscript/tree/master/fastscript/core.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bool_arg</code>(<strong><code>v</code></strong>)</p>
</blockquote>
<p>Use as <code>type</code> for <a href="/core.html#Param"><code>Param</code></a> to get <code>bool</code> behavior</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">from_name</span><span class="p">:</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;Get args from prog name instead of argparse&quot;</span><span class="p">,</span> <span class="n">bool_arg</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
      <span class="n">a</span><span class="p">:</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;param 1&quot;</span><span class="p">,</span> <span class="n">bool_arg</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
      <span class="n">b</span><span class="p">:</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;param 2&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">):</span> <span class="o">...</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="anno_parser" class="doc_header"><code>anno_parser</code><a href="https://github.com/fastai/fastscript/tree/master/fastscript/core.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>anno_parser</code>(<strong><code>func</code></strong>, <strong><code>prog</code></strong>=<em><code>None</code></em>, <strong><code>from_name</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Look at params (annotated with <a href="/core.html#Param"><code>Param</code></a>) in func and return an <code>ArgumentParser</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This converts a function with parameter annotations of type <a href="/core.html#Param"><code>Param</code></a> into an <code>argparse.ArgumentParser</code> object. Function arguments with a default provided are optional, and other arguments are positional.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">required</span><span class="p">:</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;Required param&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span>
      <span class="n">a</span><span class="p">:</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;param 1&quot;</span><span class="p">,</span> <span class="n">bool_arg</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
      <span class="n">b</span><span class="p">:</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;param 2&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">):</span>
    <span class="s2">&quot;my docs&quot;</span>
    <span class="o">...</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">anno_parser</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;progname&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>usage: progname [-h] [--a A] [--b B] [--xtra XTRA] required

my docs

positional arguments:
  required     Required param

optional arguments:
  -h, --help   show this help message and exit
  --a A        param 1 (default: 1)
  --b B        param 2 (default: test)
  --xtra XTRA  Parse for additional args
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="args_from_prog" class="doc_header"><code>args_from_prog</code><a href="https://github.com/fastai/fastscript/tree/master/fastscript/core.py#L48" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>args_from_prog</code>(<strong><code>func</code></strong>, <strong><code>prog</code></strong>)</p>
</blockquote>
<p>Extract args from <code>prog</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometimes it's convenient to extract arguments from the actual name of the called program. <a href="/core.html#args_from_prog"><code>args_from_prog</code></a> will do this, assuming that names and values of the params are separated by a <code>#</code>. Optionally there can also be a prefix separated by <code>##</code> (double underscore).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;baa&#39;</span><span class="p">}</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">args_from_prog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;foo##a#0#b#baa&#39;</span><span class="p">),</span> <span class="n">exp</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">args_from_prog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;a#0#b#baa&#39;</span><span class="p">),</span> <span class="n">exp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="call_parse" class="doc_header"><code>call_parse</code><a href="https://github.com/fastai/fastscript/tree/master/fastscript/core.py#L59" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>call_parse</code>(<strong><code>func</code></strong>)</p>
</blockquote>
<p>Decorator to create a simple CLI from <code>func</code> using <a href="/core.html#anno_parser"><code>anno_parser</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@call_parse</span>
<span class="k">def</span> <span class="nf">test_add</span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;param a&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="n">b</span><span class="p">:</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;param 1&quot;</span><span class="p">,</span><span class="nb">int</span><span class="p">)):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test-call-parse-function">Test call parse function<a class="anchor-link" href="#Test-call-parse-function"> </a></h3><p>This is a test to see if <a href="/core.html#call_parse"><code>call_parse</code></a> works as a regular function and also as a command-line interface function.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;test_fastscript &quot;Test if this still works&quot;&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">test_add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-8-da586463bcfa&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-green-fg">import</span> os
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>test_eq<span class="ansi-blue-fg">(</span>os<span class="ansi-blue-fg">.</span>system<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;test_fastscript &#34;Test if this still works&#34;&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> test_eq<span class="ansi-blue-fg">(</span>test_add<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;test_eq&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the main way to use <code>fastscript</code>; decorate your function with <a href="/core.html#call_parse"><code>call_parse</code></a>, add <a href="/core.html#Param"><code>Param</code></a> annotations as shown above, and it can then be used as a script.</p>

</div>
</div>
</div>
</div>
 

