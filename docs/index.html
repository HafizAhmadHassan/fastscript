---

title: fastscript

keywords: fastai
sidebar: home_sidebar

summary: "A fast way to turn your python function into a script."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Part of <a href="https://www.fast.ai">fast.ai</a>'s toolkit for delightful developer experiences. Written by Jeremy Howard.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install fastscript</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overview">Overview<a class="anchor-link" href="#Overview">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometimes, you want to create a quick script, either for yourself, or for others. But in Python, that involves a whole lot of boilerplate and ceremony, especially if you want to support command line arguments, provide help, and other niceties. You can use <a href="https://docs.python.org/3/library/argparse.html">argparse</a> for this purpose, which comes with Python, but it's complex and verbose.</p>
<p><code>fastscript</code> makes life easier. There are much fancier modules to help you write scripts (we recommend <a href="https://github.com/google/python-fire">Python Fire</a>, and <a href="https://click.palletsprojects.com/en/7.x/">Click</a> is also popular), but fastscript is very fast and very simple. In fact, it's &lt;50 lines of code! Basically, it's just a little wrapper around <code>argparse</code> that uses modern Python features and some thoughtful defaults to get rid of the boilerplate.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example">Example<a class="anchor-link" href="#Example">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's a complete example - it's provided in the fastscript repo as <code>examples/test_fastscript.py</code>:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fastscript</span> <span class="kn">import</span> <span class="o">*</span>
<span class="nd">@call_parse</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;The message&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span>
         <span class="n">upper</span><span class="p">:</span><span class="n">Param</span><span class="p">(</span><span class="s2">&quot;Convert to uppercase?&quot;</span><span class="p">,</span> <span class="n">bool_arg</span><span class="p">)</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">if</span> <span class="n">upper</span> <span class="k">else</span> <span class="n">msg</span><span class="p">)</span>
<span class="err">`</span>
</pre></div>
<p>When you run this script, you'll see:</p>

<pre><code>$ python examples/test_fastscript.py
usage: test_fastscript.py [-h] [--upper UPPER] msg
test_fastscript.py: error: the following arguments are required: msg</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you see, we didn't need any <code>if __name__ == "__main__"</code>, we didn't have to parse arguments, we just wrote a function, added a decorator to it, and added some annotations to our function's parameters. As a bonus, we can also use this function directly from a REPL such as Jupyter Notebook - it's not just for command line scripts!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Param">Param<a class="anchor-link" href="#Param">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Each parameter in your function should have an annotation <code>Param(...)</code> (as in the example above). You can pass the following when calling <a href="/core#Param"><code>Param</code></a>: <code>help</code>,<code>type</code>,<code>opt</code>,<code>action</code>,<code>nargs</code>,<code>const</code>,<code>choices</code>,<code>required</code> . Except for <code>opt</code>, all of these are just passed directly to <code>argparse</code>, so you have all the power of that module at your disposal. Generally you'll want to pass at least <code>help</code> (since this is provided as the help string for that parameter) and <code>type</code> (to ensure that you get the type of data you expect). <code>opt</code> is a bool that defines whether a param is optional or required (positional) - but you'll generally not need to set this manually, because fastscript will set it for you automatically based on <em>default</em> values.</p>
<p>You should provide a default (after the <code>=</code>) for any <em>optional</em> parameters. If you don't provide a default for a parameter, then it will be a <em>positional</em> parameter.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="setuptools-scripts">setuptools scripts<a class="anchor-link" href="#setuptools-scripts">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There's a really nice feature of pip/setuptools that lets you create commandline scripts directly from functions, makes them available in the <code>PATH</code>, and even makes your scripts cross-platform (e.g. in Windows it creates an exe). fastscript supports this feature too. To use it, follow <a href="fastscript/test_cli.py">this example</a> from <code>fastscript/test_cli.py</code> in the repo. As you see, it's basically identical to the script example above, except that we can treat it as a module. The trick to making this available as a script is to add a <code>console_scripts</code> section to your setup file, of the form: <code>script_name=module:function_name</code>. E.g. in this case we use: <code>test_fastscript=fastscript.test_cli:main</code>. With this, you can then just type <code>test_fastscript</code> at any time, from any directory, and your script will be called (once it's installed using one of the methods below).</p>
<p>You don't actually have to write a <code>setup.py</code> yourself. Instead, just copy the setup.py we have in the fastscript repo, and copy <code>settings.ini</code> as well. Then modify <code>settings.ini</code> as appropriate for your module/script. Then, to install your script directly, you can type <code>pip install -e .</code>. Your script, when installed this way (it's called an <a href="http://codumentary.blogspot.com/2014/11/python-tip-of-year-pip-install-editable.html">editable install</a>, will automatically be up to date even if you edit it - there's no need to reinstall it after editing.</p>
<p>You can even make your module and script available for installation directly from pip by running <code>make</code>. There shouldn't be anything else to edit - you just need to make sure you have an account on <a href="https://pypi.org/">pypi</a> and have set up a <a href="https://docs.python.org/3.3/distutils/packageindex.html#the-pypirc-file">.pypirc file</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Importing-Command-Line-Functions">Importing Command Line Functions<a class="anchor-link" href="#Importing-Command-Line-Functions">&#182;</a></h2><p>Sometimes it might be useful to also be able to import command-line functions and use them as regular functions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastscript.test_cli</span> <span class="kn">import</span> <span class="n">main</span>
<span class="n">main</span><span class="p">(</span><span class="s2">&quot;This can also be used as a regular imported function.&quot;</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>THIS CAN ALSO BE USED AS A REGULAR IMPORTED FUNCTION.
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;THIS CAN ALSO BE USED AS A REGULAR IMPORTED FUNCTION.&#39;</pre>
</div>

</div>

</div>
</div>

</div>
</div>
 

